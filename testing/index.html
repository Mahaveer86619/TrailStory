<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Leaflet Day 1</title>

    <!-- Leaflet CSS -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />

    <style>
      html,
      body {
        height: 100%;
        margin: 0;
      }
      #map {
        height: 100%;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- <script>
      // 1. Create the map
      const map = L.map("map").setView([9.287, 79.312], 13);

      // 2. Add OpenStreetMap tiles
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        maxZoom: 19,
        attribution: "© OpenStreetMap contributors",
      }).addTo(map);

      // 3. Add a marker (checkpoint)
      const checkpoint = L.marker([9.287, 79.312])
        .addTo(map)
        .bindPopup("Checkpoint 1: Starting Point");

      // 4. Draw a polyline (route)
      const routeCoordinates = [
        [9.287, 79.312],
        [9.288, 79.315],
        [9.29, 79.318],
      ];

      const routeLine = L.polyline(routeCoordinates, {
        color: "blue",
        weight: 4,
      }).addTo(map);

      // 5. Auto-fit map to route
      map.fitBounds(routeLine.getBounds());
    </script> -->
    <script>
      const map = L.map("map").setView([0, 0], 2);

      //   L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      //     maxZoom: 19,
      //     attribution: "© OpenStreetMap contributors",
      //   }).addTo(map);
      L.tileLayer(
        "https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",
        {
          maxZoom: 19,
          attribution: "© OpenStreetMap contributors © CARTO",
        }
      ).addTo(map);

      // Load journey data
      fetch("./journey.json")
        .then((response) => response.json())
        .then((journey) => {
          const routeCoords = [];

          journey.checkpoints.forEach((cp) => {
            const latlng = [cp.lat, cp.lng];

            const icon = L.icon({
              iconUrl: "marker.png",
              iconSize: [32, 32],
              iconAnchor: [16, 32],
            });

            // Marker
            L.marker(latlng, {icon}).addTo(map).bindPopup(cp.title);

            // Route
            routeCoords.push(latlng);
          });

          // Draw polyline
          const routeLine = L.polyline(routeCoords, {
            color: "blue",
            weight: 4,
          }).addTo(map);

          // Fit map to journey
          map.fitBounds(routeLine.getBounds());
        })
        .catch((err) => console.error("Failed to load journey", err));
    </script>
  </body>
</html>
